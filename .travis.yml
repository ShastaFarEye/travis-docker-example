sudo: required

services:
  - docker

before_install:
- date
- cd ${TRAVIS_BUILD_DIR}
- git clone https://github.com/guruvan/gitian-docker
- cd gitian-docker
- echo "GD_BUILD_URL=https://github.com/mazacoin/mazacoin-new" > maza-10.2.env
- echo "GD_BUILD_COMMIT=10.2" >> maza-10.2.env
- echo "GD_BUILD_COIN=maza" >> maza-10.2.env
- echo "GD_HOST_OSXSDK=${TRAVIS_BUILD_DIR}/gitian-docker/MacOSX10.9.sdk.tar.gz" >> maza-10.2.env
- echo "GD_BUILD_OSXSDK=MacOSX10.9.sdk.tar.gz" >> maza-10.2.env
- wget https://s3-us-west-2.amazonaws.com/downloads.maza.club/MacOSX10.9.sdk.tar.gz 

script:
- echo "STARTING BUILD SCRIPT AT $(date)"
- cd ${TRAVIS_BUILD_DIR}
- cd gitian-docker
- ./build.sh maza-10.2.env all
- echo "FINISHED STAGE 1 at  $(date)"
- cd ${TRAVIS_BUILD_DIR}/gitian-docker
- chmod +x ./linux.sh ./win.sh ./osx.sh
- echo "STARTING LINUX BUILD AT $(date)"
- echo "docker run -it --rm  --privileged --env-file ${GD_ENV_FILE}  -v $(pwd)/${NAMESPACE}/gitian-builder:/gitian/gitian-builder -v $(pwd)/${NAMESPACE}/${GD_BUILD_COIN}-src:/gitian/${GD_BUILD_COIN}  ${NAMESPACE}/gitian-builder linux"
- ./linux.sh
- echo "STARTING OSX BUILD AT $(date)"
- echo "docker run -it --rm  --privileged --env-file ${GD_ENV_FILE}  -v $(pwd)/${NAMESPACE}/gitian-builder:/gitian/gitian-builder -v $(pwd)/${NAMESPACE}/${GD_BUILD_COIN}-src:/gitian/${GD_BUILD_COIN}  ${NAMESPACE}/gitian-builder osx"
- ./osx.sh
- echo "STARTING WINDOWS BUILD AT $(date)"
- echo "docker run -it --rm  --privileged --env-file ${GD_ENV_FILE}  -v $(pwd)/${NAMESPACE}/gitian-builder:/gitian/gitian-builder -v $(pwd)/${NAMESPACE}/${GD_BUILD_COIN}-src:/gitian/${GD_BUILD_COIN}  ${NAMESPACE}/gitian-builder win"
- ./win.sh
- echo "You are done"

